#Towards Reliable Rootkit Detection in Live Response

http://citeseerx.ist.psu.edu/viewdoc/download?rep=rep1&type=pdf&doi=10.1.1.210.971

##摘要
传统的数据取证通过分析每个系统的硬盘的image进行，目前其方法被叫成死分析。动态的响应应该在动态（实时）环境下收集数据。目前rootkits改变实时系统的行为。
文章以提高实时响应的可信度为目标，并提出了在实时环境下有效而可靠的检测rootkit方法。

将计算机关及时，基本上失去意识行数据，如运行中的进程、开着的网络端口、内核里的模块以及RAM里面的内容，而实时响应包含可以从运行中的系统收集数据的技术。然而实时响应有可能影响到运行中的系统状态，因此一定要掌握岂可变形的系统状态，要权衡收集信息的价值和证据的完整性。

之所以Windows的rootkit简直是终结者，使因为期工具的隐身能力很强，rootkit可以隐藏进程、文件、驱动器、端口等等，加伤害可以隐藏backdoor、键盘记录。
windows系统的内核软件具有所有系统的权限。内核rootkit一般跑于内核，然而实时响应基本上跑于用户阶段，因此实时响应工具不可收集准确（内核里的）的数据。
rootkit一般通过hooking或者DKOM隐藏运行中恶意代码的存在。hooking是通过任意修改变量的值并转换控制流的方法，DKOM是Direct Kernel Object Manipulation的简称，该技术可以修改进程列表。

文中提出的工具通过启发式方法探索出来内存内的矛盾，其攻击可以发现hooking和隐藏性的内核的object。还有一些工具使用交叉视图检测，它比较函数（即包含着解析内部数据结构的结果）的输出。
文中进行了对于各种windows系统（如XP、server等等）的实验。在各种Windows系统上安装了各种rootkit，用各种rootkit探测器进行检测。每一种探测器的检测结果不同，可以一句话说除了键盘记录大部分rootkit都被发现了，而用实时响应的检测结果连一个rootkit也没被发现。

##结论

实时响应为一个事件响应和数据取证的重要部分，rootkit在内存结构的底层（即可以欺骗传统实时响应工具的位置）破坏系统，因此需要可靠地探测rootkits,为了满足其可靠性要开发另外的探测工具。

